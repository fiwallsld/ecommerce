{"ast":null,"code":"import _regeneratorRuntime from\"/Users/hoangthanh/Desktop/Code/ASM3/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/hoangthanh/Desktop/Code/ASM3/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/hoangthanh/Desktop/Code/ASM3/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{Link,Redirect}from\"react-router-dom\";import UserAPI from\"../API/UserAPI\";import{addSession}from\"../Redux/Action/ActionSession\";import{addUser}from\"../Redux/Action/ActionCart\";import\"./Auth.css\";import queryString from\"query-string\";import CartAPI from\"../API/CartAPI\";import alertify from\"alertifyjs\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function SignIn(props){var dispatch=useDispatch();var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),redirect=_useState6[0],setRedirect=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),errorRes=_useState8[0],setErrorRes=_useState8[1];var onChangeEmail=function onChangeEmail(e){setEmail(e.target.value);};var onChangePassword=function onChangePassword(e){setPassword(e.target.value);};var onSubmit=function onSubmit(){var fetchSignIn=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var params,query,response,addUserSection,addUserCart,_error$response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;params={email:email,password:password};query=\"?\"+queryString.stringify(params);_context.next=5;return UserAPI.postLogin(query);case 5:response=_context.sent;// console.log(\"Login by username, password:--\", response);\nsetErrorRes(null);localStorage.setItem(\"token\",response.user.token);addUserSection=addSession({userId:response.user.userId,email:response.user.email,fullname:response.user.fullname,token:response.user.token,roomId:response.user.roomId});addUserCart=addUser({userId:response.user.userId,listCart:response.user.cart});dispatch(addUserSection);dispatch(addUserCart);alertify.set(\"notifier\",\"position\",\"top-center\");alertify.success(response.message);setRedirect(true);_context.next=20;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](0);// console.log(error.response?.data);\nsetErrorRes((_error$response=_context.t0.response)===null||_error$response===void 0?void 0:_error$response.data);case 20:case\"end\":return _context.stop();}},_callee,null,[[0,17]]);}));return function fetchSignIn(){return _ref.apply(this,arguments);};}();fetchSignIn();};return/*#__PURE__*/_jsx(\"div\",{className:\"limiter\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container-login100\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"wrap-login100 p-l-55 p-r-55 p-t-65 p-b-50\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"login100-form-title p-b-33\",children:\"Sign In\"}),/*#__PURE__*/_jsx(\"div\",{className:\"wrap-input100 validate-input\",children:/*#__PURE__*/_jsx(\"input\",{className:\"input100\",type:\"text\",placeholder:\"Email\",value:email,onChange:onChangeEmail})}),(errorRes===null||errorRes===void 0?void 0:errorRes.email)&&/*#__PURE__*/_jsx(\"span\",{className:\"text-danger\",children:errorRes.email}),/*#__PURE__*/_jsx(\"div\",{className:\"wrap-input100 rs1 validate-input\",children:/*#__PURE__*/_jsx(\"input\",{className:\"input100\",type:\"password\",placeholder:\"Password\",value:password,onChange:onChangePassword})}),(errorRes===null||errorRes===void 0?void 0:errorRes.password)&&/*#__PURE__*/_jsx(\"span\",{className:\"text-danger\",children:errorRes.password}),/*#__PURE__*/_jsxs(\"div\",{className:\"container-login100-form-btn m-t-20\",children:[redirect&&/*#__PURE__*/_jsx(Redirect,{to:\"/\"}),/*#__PURE__*/_jsx(\"button\",{className:\"login100-form-btn\",onClick:onSubmit,children:\"Sign in\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center p-t-45 p-b-4\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"txt1\",children:\"Create an account?\"}),\"\\xA0\",/*#__PURE__*/_jsx(Link,{to:\"/signup\",className:\"txt2 hov1\",children:\"Sign up\"})]})]})})});}export default SignIn;","map":{"version":3,"names":["React","useEffect","useState","useDispatch","useSelector","Link","Redirect","UserAPI","addSession","addUser","queryString","CartAPI","alertify","jsx","_jsx","jsxs","_jsxs","SignIn","props","dispatch","_useState","_useState2","_slicedToArray","email","setEmail","_useState3","_useState4","password","setPassword","_useState5","_useState6","redirect","setRedirect","_useState7","_useState8","errorRes","setErrorRes","onChangeEmail","e","target","value","onChangePassword","onSubmit","fetchSignIn","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","params","query","response","addUserSection","addUserCart","_error$response","wrap","_callee$","_context","prev","next","stringify","postLogin","sent","localStorage","setItem","user","token","userId","fullname","roomId","listCart","cart","set","success","message","t0","data","stop","apply","arguments","className","children","type","placeholder","onChange","to","onClick"],"sources":["/Users/hoangthanh/Desktop/Code/ASM3/client/src/Authentication/SignIn.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Link, Redirect } from \"react-router-dom\";\nimport UserAPI from \"../API/UserAPI\";\nimport { addSession } from \"../Redux/Action/ActionSession\";\nimport { addUser } from \"../Redux/Action/ActionCart\";\nimport \"./Auth.css\";\nimport queryString from \"query-string\";\nimport CartAPI from \"../API/CartAPI\";\nimport alertify from \"alertifyjs\";\n\nfunction SignIn(props) {\n  const dispatch = useDispatch();\n\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [redirect, setRedirect] = useState(false);\n  const [errorRes, setErrorRes] = useState(null);\n\n  const onChangeEmail = (e) => {\n    setEmail(e.target.value);\n  };\n\n  const onChangePassword = (e) => {\n    setPassword(e.target.value);\n  };\n\n  const onSubmit = () => {\n    const fetchSignIn = async () => {\n      try {\n        const params = {\n          email: email,\n          password: password,\n        };\n        const query = \"?\" + queryString.stringify(params);\n        const response = await UserAPI.postLogin(query);\n\n        // console.log(\"Login by username, password:--\", response);\n        setErrorRes(null);\n        localStorage.setItem(\"token\", response.user.token);\n\n        const addUserSection = addSession({\n          userId: response.user.userId,\n          email: response.user.email,\n          fullname: response.user.fullname,\n          token: response.user.token,\n          roomId: response.user.roomId,\n        });\n\n        const addUserCart = addUser({\n          userId: response.user.userId,\n          listCart: response.user.cart,\n        });\n\n        dispatch(addUserSection);\n        dispatch(addUserCart);\n\n        alertify.set(\"notifier\", \"position\", \"top-center\");\n        alertify.success(response.message);\n        setRedirect(true);\n      } catch (error) {\n        // console.log(error.response?.data);\n        setErrorRes(error.response?.data);\n      }\n    };\n\n    fetchSignIn();\n  };\n\n  return (\n    <div className=\"limiter\">\n      <div className=\"container-login100\">\n        <div className=\"wrap-login100 p-l-55 p-r-55 p-t-65 p-b-50\">\n          <span className=\"login100-form-title p-b-33\">Sign In</span>\n\n          <div className=\"wrap-input100 validate-input\">\n            <input\n              className=\"input100\"\n              type=\"text\"\n              placeholder=\"Email\"\n              value={email}\n              onChange={onChangeEmail}\n            />\n          </div>\n          {errorRes?.email && (\n            <span className=\"text-danger\">{errorRes.email}</span>\n          )}\n\n          <div className=\"wrap-input100 rs1 validate-input\">\n            <input\n              className=\"input100\"\n              type=\"password\"\n              placeholder=\"Password\"\n              value={password}\n              onChange={onChangePassword}\n            />\n          </div>\n          {errorRes?.password && (\n            <span className=\"text-danger\">{errorRes.password}</span>\n          )}\n\n          <div className=\"container-login100-form-btn m-t-20\">\n            {redirect && <Redirect to={`/`} />}\n            <button className=\"login100-form-btn\" onClick={onSubmit}>\n              Sign in\n            </button>\n          </div>\n\n          <div className=\"text-center p-t-45 p-b-4\">\n            <span className=\"txt1\">Create an account?</span>\n            &nbsp;\n            <Link to=\"/signup\" className=\"txt2 hov1\">\n              Sign up\n            </Link>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default SignIn;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}